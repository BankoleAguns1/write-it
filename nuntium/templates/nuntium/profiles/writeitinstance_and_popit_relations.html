{% extends "base_manager.html" %}
{% load i18n %}
{% load subdomainurls %}
{% load staticfiles %}
{% load pagination_tags %}


{% block extrascripts %}
<link rel="stylesheet" href="{% static 'css/chosen.css' %}">
<script src="{% static 'js/chosen.jquery.min.js' %}"></script>
{% endblock extrascripts %}
{% block extrajs %}
$(".chosen-person-select").chosen();
{% endblock extrajs %}

{% block header %}

{% include 'nuntium/profiles/per_instance_top_menu.html' with section='relate-writeit-popit' %}

{% endblock header %}

{% block content %}

{% if messages %}
  <div class="alert alert-info" role="alert">
    {% for message in messages %}
    <p{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</p>
    {% endfor %}
  </div>
{% endif %}

  <div class="page-header">
    <h2>{% trans "Data Sources" %}</h2>
  </div>

      {% autopaginate relations %}
      {% paginate %}
        {% for record in relations %}
          <ul class="list-of-data-sources">
            <li class="list-of-data-sources__data-source">
              <h3 class="data-source__title"><a href="{{ record.popitapiinstance.url }}">{{ record.popitapiinstance.url }}</a></h3>
              <p class="data-source__info"><i class="data-source__status-indicator data-source__status-indicator--{{ record.status }}"></i>{{ record.status }} <span class="muted">&mdash; last updated {{ record.updated }}</span></p>
              <div class="data-source__controls">
                <ul>
                  <li><a data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample">{% trans 'Edit' %}</a></li>
                </ul>
              </div>
              <div class="collapse data-source__edit" id="collapseExample">
                <div class="well">
                  <h3>{% trans 'Polling interval' %}</h3>
                  <form class="form-inline">
                    <div class="form-group">
                      <label for="polling-interval-select">{% trans 'Fetch new data from this source' %}</label>
                      <select class="form-control" id="polling-interval-select">
                        <option>{% trans 'Never' %}</option>
                        <option>{% trans 'Twice a day' %}</option>
                        <option>{% trans 'Daily' %}</option>
                        <option>{% trans 'Weekly' %}</option>
                      </select>

                      </div>
                      <div class="save-bar">
                       <button class="btn btn-default"><i class="glyphicon glyphicon-refresh"></i> {% trans 'Fetch new data now' %}</button>
                       <button type="submit" class="btn btn-primary">{% trans 'Save' %}</button>
                      </div>
                      </form>

                </div>
              </div>
            </li>
          </ul>
        {% endfor %}
      {% paginate %}

  <div class="add-new-data-source">
    <form action="{% url 'relate-writeit-popit' subdomain=writeitinstance.slug %}" method="POST" role="form">
    <h3>{% trans "Add a new data source" %}</h3>
      {% csrf_token %}
      <div class="form-element">
        <div class="form-inline">
          {{ form.popit_url.label_tag }}
          {{ form.popit_url }}
          <button type="submit" class="btn btn-primary">{% trans 'Add' %}</button>
        </div>
      </div>
    </form>
  </div>
{% endblock content %}
